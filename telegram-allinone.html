<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All-in-One Video Player Plus</title>
<style>
  body { font-family: Arial, sans-serif; background: #111; color: #fff; margin:0; padding:20px; text-align:center; }
  .container { max-width: 900px; margin:auto; }
  input, button { padding:10px; margin:5px; border-radius:5px; border:none; }
  input { width:60%; }
  button { background:#0a84ff; color:#fff; cursor:pointer; }
  button:hover { background:#0066cc; }
  video { width:100%; max-height:500px; margin-top:20px; border-radius:10px; background:#000;}
  .video-list { margin-top:20px; display:flex; flex-wrap:wrap; justify-content:center; gap:10px; }
  .video-item { position:relative; width:200px; }
  .video-item button { width:100%; margin:0; }
  .video-item .delete-btn { position:absolute; top:0; right:0; background:red; color:#fff; border-radius:0 0 0 5px; padding:2px 5px; font-size:12px; cursor:pointer; }
  .output { margin-top:15px; }
  .thumbnail { width:100%; height:110px; object-fit:cover; border-radius:5px; background:#000; }
</style>
</head>
<body>
<div class="container">
  <h2>All-in-One Video Player Plus</h2>
  <p>Masukkan link video MP4 dan judul custom:</p>
  <input type="text" id="videoLink" placeholder="Paste link MP4 di sini">
  <input type="text" id="videoTitle" placeholder="Judul video (opsional)">
  <button onclick="addVideo()">Tambah Video</button>

  <div class="output" id="result"></div>
  <video id="player" controls></video>

  <div class="video-list" id="videoList"></div>
</div>

<script>
const videoList = []; // Array menyimpan semua video

// Tambah video baru
function addVideo(){
  const link = document.getElementById("videoLink").value.trim();
  if(!link) return;
  const title = document.getElementById("videoTitle").value.trim() || `Video ${videoList.length+1}`;
  
  videoList.push({link, title});
  renderVideoList();
  playVideo(link);

  // Generate link share Base64
  const encoded = btoa(link);
  const finalUrl = window.location.origin + window.location.pathname + "?video=" + encoded;
  document.getElementById("result").innerHTML = `
    <p>Link share (siap copy):</p>
    <input type="text" value="${finalUrl}" readonly onclick="this.select()">
  `;

  document.getElementById("videoLink").value = "";
  document.getElementById("videoTitle").value = "";
}

// Render daftar video dengan thumbnail dan tombol hapus
function renderVideoList(){
  const listDiv = document.getElementById("videoList");
  listDiv.innerHTML = "";
  videoList.forEach((v, idx) => {
    const item = document.createElement("div");
    item.className = "video-item";

    // Thumbnail video
    const thumb = document.createElement("video");
    thumb.src = v.link;
    thumb.muted = true;
    thumb.preload = "metadata";
    thumb.className = "thumbnail";

    // Tombol play dengan judul
    const btn = document.createElement("button");
    btn.textContent = v.title;
    btn.onclick = () => playVideo(v.link);

    // Tombol hapus
    const del = document.createElement("div");
    del.className = "delete-btn";
    del.textContent = "X";
    del.onclick = () => {
      videoList.splice(idx,1);
      renderVideoList();
      if(videoList.length>0) playVideo(videoList[0].link);
      else document.getElementById("player").src = "";
    };

    item.appendChild(thumb);
    item.appendChild(btn);
    item.appendChild(del);
    listDiv.appendChild(item);
  });
}

// Putar video
function playVideo(link){
  const player = document.getElementById("player");
  player.src = link;
  player.load();
  player.play();
}

// Auto-load video dari parameter ?video=
window.onload = function(){
  const params = new URLSearchParams(window.location.search);
  const encoded = params.get("video");
  if(encoded){
    try{
      const url = atob(encoded);
      videoList.push({link: url, title: `Video 1`});
      renderVideoList();
      playVideo(url);
    } catch(e){
      document.getElementById("result").innerHTML = "<p>Link video tidak valid!</p>";
    }
  }
};
</script>
</body>
</html>

// Auto-load link dari parameter ?link=
window.onload = function(){
  const params = new URLSearchParams(window.location.search);
  const encoded = params.get("link");
  if(encoded){
    try{
      const url = atob(encoded);
      showTelegram(url);
    } catch(e){
      document.getElementById("player").innerHTML = "<p>Link tidak valid!</p>";
    }
  }
};
</script>
</body>
</html>
