<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telegram Player & Generator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #fff;
    margin: 0;
    padding: 20px;
    text-align: center;
  }
  .container {
    max-width: 700px;
    margin: auto;
    background: #1a1a1a;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px #000;
  }
  input, button {
    padding: 10px;
    margin: 5px;
    border-radius: 5px;
    border: none;
  }
  input {
    width: 70%;
  }
  button {
    background: #0a84ff;
    color: #fff;
    cursor: pointer;
  }
  button:hover {
    background: #0066cc;
  }
  .output {
    margin-top: 15px;
  }
  iframe {
    width: 100%;
    height: 500px;
    border: none;
    margin-top: 20px;
  }
</style>
</head>
<body>
<div class="container">
  <h2>Telegram Player & Generator</h2>
  <p>Masukkan link posting Telegram (contoh: https://t.me/mrzybfilm/3578)</p>

  <input type="text" id="telegramLink" placeholder="Paste link Telegram di sini">
  <button onclick="generateLink()">Buat Link</button>

  <div class="output" id="result"></div>
  <div id="player"></div>
</div>

<script>
// Fungsi tampilkan widget Telegram
function showTelegram(url){
  const match = url.match(/t\.me\/([^/]+)\/(\d+)/);
  const playerDiv = document.getElementById("player");
  playerDiv.innerHTML = ""; // Hapus widget lama
  if(match){
    const channel = match[1];
    const post = match[2];
    const script = document.createElement("script");
    script.async = true;
    script.src = "https://telegram.org/js/telegram-widget.js?22";
    script.setAttribute("data-telegram-post", channel + "/" + post);
    script.setAttribute("data-width", "100%");
    script.setAttribute("data-dark", "1");
    playerDiv.appendChild(script);
  } else {
    playerDiv.innerHTML = "<p>Link tidak dikenali.</p>";
  }
}

// Fungsi buat link Base64
function generateLink(){
  const link = document.getElementById("telegramLink").value.trim();
  if(!link) return;
  const encoded = btoa(link);
  const finalUrl = window.location.origin + window.location.pathname + "?link=" + encoded;
  document.getElementById("result").innerHTML = `
    <p>Link hasil (siap share):</p>
    <input type="text" value="${finalUrl}" readonly onclick="this.select()">
  `;
  showTelegram(link);
}

// Auto-load link dari parameter ?link=
window.onload = function(){
  const params = new URLSearchParams(window.location.search);
  const encoded = params.get("link");
  if(encoded){
    try{
      const url = atob(encoded);
      showTelegram(url);
    } catch(e){
      document.getElementById("player").innerHTML = "<p>Link tidak valid!</p>";
    }
  }
};
</script>
</body>
</html>
